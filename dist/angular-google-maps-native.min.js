/*! angular-google-maps-native v2.0.1 |  | DEMONTE Jean-Baptiste | jbdemonte@gmail.com | GPL v3 */
!function(n,t){"use strict";function e(t){var e=L.defer();return b("Geocoder").geocode(n.isString(t)?{address:t}:t,function(n,t){t===$.GeocoderStatus.OK?e.resolve(n[0].geometry.location,n):(i("geocode: "+t),e.reject())}),e.promise}function i(){console&&console.error.apply(console,arguments)}function r(n){return(n.ngShow?"("+n.ngShow+")":"")+(n.ngHide?(n.ngShow?" && ":"")+"!("+n.ngHide+")":"")||""}function o(n){return n}function u(n){if(n=1*n,!isNaN(n))return n}function c(t){var e,i,r;return t instanceof $.LatLng?t:(n.isArray(t)?(e=u(t[0]),i=u(t[1])):n.isObject(t)&&(e=u(t.lat),i=u(t.lng)),q(e)&&q(i)&&(r=new $.LatLng(e,i)),r)}function a(e){var i,r,o;return!e||e instanceof $.LatLngBounds?e||t:(n.isArray(e)?2===e.length?(i=c(e[0]),r=c(e[1])):4===e.length&&(i=c([e[0],e[1]]),r=c([e[2],e[3]])):"ne"in e&&"sw"in e?(i=c(e.ne),r=c(e.sw)):"n"in e&&"e"in e&&"s"in e&&"w"in e&&(i=c([e.n,e.e]),r=c([e.s,e.w])),i&&r&&(o=new $.LatLngBounds(r,i)),o)}function s(n){return n+="",k(n.charAt(0))+n.substr(1)}function f(n){return n+="",n.charAt(0).toUpperCase()+n.substr(1)}function l(n,t){var e;return function(){return n&&(e=n.apply(t||this,arguments),n=null),e}}function p(n){return k(n.replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/^[^_]+_/,""))}function g(n,t,e){T(e,function(e,i){var r=i.match(/^on(ce)?[A-Z]/);r&&$.event["addListener"+(r[1]?"Once":"")](n,p(i),function(n){S(function(){t.$apply(function(){var i=t.$new(!1);i.event=n,M(e)(i)})})})})}function d(t,i,r){var o,u;return j in i&&(u=t.$watch(i[j],function(t){o=t,t&&e(t).then(function(e){n.equals(o,t)&&r(e)})})),u}function m(n,t,e,i,r){function o(n){e.then(function(t){n=r(n),q(n)&&t["set"+f(i)](n)})}var u=k(i);u in t&&n.$watch(t[u],function(n){q(n)&&o(n)}),r===c&&d(n,t,function(n){o(n)})}function v(n,t,e,i){T(i,function(i,r){m(n,t,e,r,i)}),"options"in t&&m(n,t,e,"options",function(n){return T(i,function(t,e){e in n&&(n[e]=t(n[e]))}),n})}function h(t,e,r,o,u){function a(){var n=!0;return T(f,function(t){q(g[t])&&r[t]&&(g[t]=r[t](g[t])),n=n&&q(g[t])}),n}function s(){if(a())return u&&T(p,function(n){n()}),o(g),u}var f,l,p=[],g={};n.isString(r)?(f=r.split(" "),r={}):f=Object.keys(r),e.options&&(g=M(e.options)(t)),s()||T(f,function(n){var o=!1,u=k(n);u in e&&(o=!0,p.push(t.$watch(e[u],function(t){q(t)&&(g[n]=t,s())}))),r[n]===c&&(l=d(t,e,function(t){g[n]=t,s()}),l&&(o=!0,p.push(l))),o||q(g[n])||i(n+" missing")})}function y(e,i){var o=[i.directive||"gm"+f(k(e))];return n.isArray(i.require)?Array.prototype.push.apply(o,i.require):i.require&&n.isString(i.require)&&o.push(i.require),o.push("^gmMap"),{restrict:"E",scope:!0,require:o,controller:["$scope","$element","$attrs",function(n,o,u){function c(t){var e=r(u),c=p.get();e?n.$watch(e,function(e){a?i.visibility?i.visibility(n,o,u,d,e):a.setMap(e?c:null):(f(t,c,e),i.visibility&&i.visibility(n,o,u,d,e))}):f(t,c,!0)}var a,f,p,d,m=i.name||s(e),y=this,w=L.defer();n.$on("$destroy",function(){a?(i.destroy?i.destroy(n,o,u,a):a.setMap(t),a=t,delete n[m]):w.reject()}),f=l(function(t,r,c){var s=i.opts?t.opts||{}:t;!c&&s.map&&delete s.map,a=i.instantiate?i.instantiate(n,o,u,t):new $[e](t),c&&!s.map&&a.setMap&&a.setMap(r),n[m]=a,g(a,n,u),w.resolve(a)}),y.init=l(function(t){d=t,p=d[d.length-1],p.then(function(t){var e={};i.create&&(u.options&&(e=M(u.options)(n),T(i.main,function(n,t){t in e&&(e[t]=n(e[t]))})),i.create(n,o,u,d,e,c))||h(n,u,i.main,function(e){i.opts?(e.opts=e.opts||{},e.opts.map=t):e.map=t,c(e),v(n,u,y,i.main)},!0)}),u.gmThen&&y.then(function(){M(u.gmThen)(n.$new(!1))})}),y.then=function(n){w.promise.then(n)},y.get=function(){return a}}],link:function(n,t,e,i){i[0].init(i)}}}function w(t,e){return y(t,n.extend({create:function(n,t,e,i,r,o){return e.ngShow||e.ngHide||i[0].then(function(n){n.setMap(i[1].get())}),o(r),!0}},e))}var $,b,L,M,S,T=n.forEach,q=n.isDefined,k=function(n){return n.toLowerCase()},j="gmAddress";b=function(){var n={};return function(t){return!n.hasOwnProperty(t)&&$[t]&&(n[t]=new $[t]),n[t]}}(),n.module("GoogleMapsNative",[]).provider("gmLibrary",function(){function t(){var n=u.url,t=n.indexOf("?");return t===-1?n+="?":t===n.length-1&&(n+="&"),T(u,function(t,e){o.indexOf(e)===-1&&(n+=e+"="+t+"&")}),u.libraries.length&&(n+="libraries="+u.libraries.join(",")),n}function e(n,e){var o,c=u.callback;return r||(r=!0,i=L.defer(),e.google&&e.google.maps?(i.resolve(),$=e.google.maps):(e[c]=function(){if(delete e[c],$=e.google.maps,!$)throw"google.maps library not found";i.resolve()},o=n[0].createElement("script"),o.type="text/javascript",o.src=t(),n.find("body").append(o))),i.promise}var i,r=!1,o=["url","libraries"],u={url:"https://maps.googleapis.com/maps/api/js",v:3,libraries:[],language:"en",sensor:"false",callback:"__mapLibraryLoaded"};this.configure=function(t){n.extend(u,t)},this.$get=["$document","$window","$rootScope","$q","$parse","$timeout",function(n,t,i,r,o,c){return L=r,M=o,S=c,{populate:function(n){n.google=t.google,i.google=t.google},load:function(){var i;return u.load?(i=L.defer(),u.load(i),i.promise.then(function(){return e(n,t)})):e(n,t)}}}]}).directive("gmMap",["gmLibrary",function(e){return{restrict:"E",scope:!0,controller:["$scope","$element","$attrs",function(i,a,s){function f(n){var t=r(s);t?i.$watch(t,function(t){t&&(p?S(function(){$.event.trigger(p,"resize")}):d(n))}):d(n)}var p,d,m=this,y=L.defer(),w=n.element(document.createElement("DIV"));a.css("position")||a.css("position","relative"),w.css({position:"absolute",top:0,right:0,bottom:0,left:0}),a.append(w),i.$on("$destroy",function(){p?(p=t,delete i.map):y.reject()}),d=l(function(n){S(function(){p=new $.Map(w[0],n),i.map=p,g(p,i,s),y.resolve(p)},100)}),m.init=function(){e.load().then(function(){e.populate(i),h(i,s,{center:c,zoom:u},function(n){f(n),v(i,s,m,{center:c,zoom:u,mapTypeId:o,heading:u,tilt:u})},!0)}),s.gmThen&&m.then(function(){M(s.gmThen)(i.$new(!1))})},m.then=function(n){y.promise.then(n)},m.get=function(){return p}}],link:function(n,t,e,i){i.init()}}}]).directive("gmMarker",function(){return y("Marker",{main:{position:c}})}).directive("gmCircle",function(){return y("Circle",{main:{center:c,radius:u}})}).directive("gmRectangle",function(){return y("Rectangle",{main:{bounds:a}})}).directive("gmInfowindow",function(){return y("InfoWindow",{require:"^?gmMarker",main:{position:c},destroy:function(n,t,e,i){i.close()},create:function(n,t,e,i,r,o){var u=i[0],a=i[1],s=i[2],f=function(n){o(n),e.ngShow||e.ngHide||u.then(function(n){n.open(s.get(),a?a.get():null)})};return a?a.then(function(){f(r)}):h(n,e,{position:c},function(t){f(t),v(n,e,i[0],{position:c})},!0),!0},visibility:function(n,t,e,i,r){var o=i[0].get(),u=i[1],c=i[2];return r?void o.open(c.get(),u?u.get():null):o.close()}})}).directive("gmDirections",function(){return{restrict:"E",scope:!0,require:["gmDirections","^gmMap"],controller:["$scope",function(n){var t=L.defer(),e={result:null,status:""};this._run=function(i){i.origin=c(i.origin)||i.origin,i.destination=c(i.destination)||i.destination,b("DirectionsService").route(i,function(i,r){e.result=i,e.status=r,n.$apply(function(){n.directions={result:i,status:r}}),t.resolve(e)})},this.then=function(n){t.promise.then(n)},this.get=function(){return e}}],link:function(n,t,e,i){var r=i[0],o=i[1];o.then(function(){h(n,e,"origin destination travelMode",function(n){r._run(n)})})}}}).directive("gmRenderer",function(){return y("DirectionsRenderer",{directive:"gmRenderer",name:"renderer",require:"^gmDirections",create:function(n,t,e,i,r,o){var u=i[0],c=i[1],a=i[2];return c.then(function(t){r.map=a.get(),r.directions=t.result,n.$watch("directions",function(n){u.get().setDirections(n.result)}),o(r)}),!0}})}).directive("gmPolyline",function(){return y("Polyline",{main:{path:function(n){return T(n,function(t,e){n[e]=c(t)}),n}}})}).directive("gmPolygon",function(){return y("Polygon",{main:{paths:function(n){return T(n,function(t,e){n[e]=c(t)}),n}}})}).directive("gmGroundoverlay",function(){return y("GroundOverlay",{opts:!0,instantiate:function(n,t,e,i){return new $.GroundOverlay(i.url,i.bounds,i.opts)},create:function(n,t,e,i,r,o){return i[1].then(function(){h(n,e,"url bounds",function(n){n.bounds=a(n.bounds),o(n)},!0)}),!0}})}).directive("gmKmllayer",function(){return y("KmlLayer",{opts:!0,main:{url:o},instantiate:function(n,t,e,i){return new $.KmlLayer(i.url,i.opts)}})}).directive("gmStyledmaptype",function(){return{restrict:"E",require:"^gmMap",link:function(n,e,i,r){r.then(function(e){n.map=e,e.mapTypes.set(i.id,new $.StyledMapType(M(i.styles)(n),i.options?M(i.options)(n):t))})}}}).directive("gmTrafficlayer",function(){return w("TrafficLayer")}).directive("gmBicyclinglayer",function(){return w("BicyclingLayer")}).directive("gmTransitlayer",function(){return w("TransitLayer")}).directive("gmStreetviewpanorama",["gmLibrary",function(n){return{restrict:"E",scope:!0,controller:["$scope","$element","$attrs",function(e,i,a){function s(n){var t=r(a);t?e.$watch(t,function(t){t&&(f?S(function(){$.event.trigger(f,"resize")}):p(n))}):p(n)}var f,p,d=this,m=L.defer();e.$on("$destroy",function(){f?(f=t,delete e.streetViewPanorama):m.reject()}),p=l(function(n){S(function(){f=new $.StreetViewPanorama(i[0],n),e.streetViewPanorama=f,g(f,e,a),m.resolve(f)},100)}),d.init=l(function(){n.load().then(function(){n.populate(e),h(e,a,{position:c},function(n){s(n),v(e,a,d,{position:c,pov:o,zoom:u})},!0)}),a.gmThen&&d.then(function(){M(a.gmThen)(e.$new(!1))})}),d.then=function(n){m.promise.then(n)},d.get=function(){return f}}],link:function(n,t,e,i){i.init()}}}])}(angular);